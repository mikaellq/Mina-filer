<!DOCTYPE html>
<html lang="sv">

<head>
    <title>Mikael's Bootstrap Page!</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        canvas {
            border: 1px solid #d3d3d3;
            background-color: #f1f1f1;
        }
    </style>
</head>

<body id="game" scroll="no" style="overflow: hidden" onload="startGame()">
    <script>
        var myGamePiece;
        var posX = 3,
            posY = 5;
        const width = 30,
            height = 30;
        const cwidth = 16,
            cheight = 16;
        var a = [
            [10, 16],
            [10, 15],
            [10, 14],
            [10, 13],
            [10, 12],
            [10, 11],
            [10, 10],
            [10, 9],
            [10, 8],
            [10, 7],
            [10, 6],
            [10, 5],
            [10, 4],
            [5, 0],
            [5, 1],
            [5, 2],
            [5, 3],
            [5, 4],
            [5, 5],
            [5, 6],
            [5, 7],
            [5, 8],
            [5, 9],
            [5, 10],
            [5, 11],
            [5, 12]
        ];

        var stones = [
            [2, 2],
            [3, 3],
            [4, 4],
            [8, 10]
        ];
        
        document.getElementById("game").addEventListener("keydown", myFunction);

        function myFunction() {
            //document.getElementById("demo").style.backgroundColor = "red";
            //left: 37, right: 39, up: 38, down: 40

            var key = event.keyCode;
            //alert("You pressed "+key);

            switch (key) {
                case 37:
                    moveMyPiece(-1, 0);
                    //alert("You pressed 37");
                    break;
                case 39:
                    moveMyPiece(1, 0);
                    //alert("You pressed 39");
                    break;
                case 38:
                    moveMyPiece(0, -1);
                    //alert("You pressed 38");
                    break;
                case 40:
                    moveMyPiece(0, 1);
                    //alert("You pressed 40");
                    break;
                default:
                    //alert("Use the arrow keys dummy!");
            }
        }

        function startGame() {
            myGameArea.start();
            myGamePiece = new component(width, height, "green", posX * width, posY * height);
            var t = writeArea();
        }

        var myGameArea = {
            canvas: document.createElement("canvas"),
            start: function() {
                this.canvas.width = cwidth * width;
                this.canvas.height = cheight * height;
                this.context = this.canvas.getContext("2d");
                document.body.insertBefore(this.canvas, document.body.childNodes[0]);
            }
        }

        function component(w, h, color, x, y) {
            this.width = w;
            this.height = h;
            this.x = x;
            this.y = y;
            ctx = myGameArea.context;
            ctx.fillStyle = color;
            ctx.fillRect(this.x, this.y, this.width, this.height);
        }

        function moveMyPiece(x, y) {
            myGamePiece = new component(width, height, "#f1f1f1", posX * width, posY * height);
            var test = findElement(a, posX + x, posY + y);
            if (posX + x >= 0 && posX + x < cwidth && test < 0) {
                posX += x;
            }

            if (posY + y >= 0 && posY + y < cheight && test < 0) {
                posY += y;
            }

            myGamePiece = new component(width, height, "green", posX * width, posY * height);
        }

        function findElement(e, x, y) {
            for (i = 0; i < e.length; i++) {
                if (e[i][0] == x) {
                    if (e[i][1] == y) {
                        return i;
                    }
                }
            }
            return -1;
        }

        function writeArea() {
            //alert("TEST!");
            for (i = 0; i < a.length; i++) {
                var t = new component(30, 30, "red", a[i][0] * width, a[i][1] * height);
            }

            for (i = 0; i < stones.length; i++) {
                var t = new component(30, 30, "blue", stones[i][0] * width, stones[i][1] * height);
            }

            return 1;
        }
    </script>
</body>

</html>
